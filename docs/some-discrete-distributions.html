<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Book of Prob</title>
  <meta name="description" content="A book for introduction to probability.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Book of Prob" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A book for introduction to probability." />
  <meta name="github-repo" content="berkorbay/book-of-prob" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Book of Prob" />
  
  <meta name="twitter:description" content="A book for introduction to probability." />
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="expectation-and-variance.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><b><a href="./">Book of Prob</a></b></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i>About the Author</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Initial Concepts of Probability</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#set-operations"><i class="fa fa-check"></i><b>1.1</b> Set Operations</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#axioms-of-probability"><i class="fa fa-check"></i><b>1.2</b> Axioms of Probability</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#other-set-and-probability-rules"><i class="fa fa-check"></i><b>1.3</b> Other Set and Probability Rules</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#counting"><i class="fa fa-check"></i><b>1.4</b> Counting</a><ul>
<li class="chapter" data-level="1.4.1" data-path="intro.html"><a href="intro.html#multiplication-rule"><i class="fa fa-check"></i><b>1.4.1</b> Multiplication Rule</a></li>
<li class="chapter" data-level="1.4.2" data-path="intro.html"><a href="intro.html#permutation-rule"><i class="fa fa-check"></i><b>1.4.2</b> Permutation Rule</a></li>
<li class="chapter" data-level="1.4.3" data-path="intro.html"><a href="intro.html#combination-rule"><i class="fa fa-check"></i><b>1.4.3</b> Combination Rule</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#chapter-problems"><i class="fa fa-check"></i><b>1.5</b> Chapter Problems</a></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#extra-problems"><i class="fa fa-check"></i><b>1.6</b> Extra Problems</a></li>
<li class="chapter" data-level="1.7" data-path="intro.html"><a href="intro.html#coins-dice-and-cards"><i class="fa fa-check"></i><b>1.7</b> Coins, Dice and Cards</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cond.html"><a href="cond.html"><i class="fa fa-check"></i><b>2</b> Conditional Probability and Bayes’ Rule</a><ul>
<li class="chapter" data-level="2.1" data-path="cond.html"><a href="cond.html#some-examples"><i class="fa fa-check"></i><b>2.1</b> Some Examples</a></li>
<li class="chapter" data-level="2.2" data-path="cond.html"><a href="cond.html#conditional-probability"><i class="fa fa-check"></i><b>2.2</b> Conditional Probability</a></li>
<li class="chapter" data-level="2.3" data-path="cond.html"><a href="cond.html#independence"><i class="fa fa-check"></i><b>2.3</b> Independence</a></li>
<li class="chapter" data-level="2.4" data-path="cond.html"><a href="cond.html#product-rule"><i class="fa fa-check"></i><b>2.4</b> Product rule</a></li>
<li class="chapter" data-level="2.5" data-path="cond.html"><a href="cond.html#bayes-rule"><i class="fa fa-check"></i><b>2.5</b> Bayes’ Rule</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html"><i class="fa fa-check"></i><b>3</b> Random Variables and Distributions</a><ul>
<li class="chapter" data-level="3.1" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#scales-on-measurement"><i class="fa fa-check"></i><b>3.1</b> Scales on Measurement</a></li>
<li class="chapter" data-level="3.2" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#infinity"><i class="fa fa-check"></i><b>3.2</b> Infinity</a></li>
<li class="chapter" data-level="3.3" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#descriptive-statistics"><i class="fa fa-check"></i><b>3.3</b> Descriptive Statistics</a></li>
<li class="chapter" data-level="3.4" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#random-variables"><i class="fa fa-check"></i><b>3.4</b> Random Variables</a></li>
<li class="chapter" data-level="3.5" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#discrete-random-variables-and-distributions"><i class="fa fa-check"></i><b>3.5</b> Discrete Random Variables and Distributions</a><ul>
<li class="chapter" data-level="3.5.1" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#cumulative-distribution-function-cdf"><i class="fa fa-check"></i><b>3.5.1</b> Cumulative Distribution Function (CDF)</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#continuous-random-variables-and-distributions"><i class="fa fa-check"></i><b>3.6</b> Continuous Random Variables and Distributions</a></li>
<li class="chapter" data-level="3.7" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#joint-distribution"><i class="fa fa-check"></i><b>3.7</b> Joint Distribution</a></li>
<li class="chapter" data-level="3.8" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#marginal-distribution"><i class="fa fa-check"></i><b>3.8</b> Marginal Distribution</a></li>
<li class="chapter" data-level="3.9" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#conditional-distribution"><i class="fa fa-check"></i><b>3.9</b> Conditional Distribution</a></li>
<li class="chapter" data-level="3.10" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#statistical-independence"><i class="fa fa-check"></i><b>3.10</b> Statistical Independence</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="expectation-and-variance.html"><a href="expectation-and-variance.html"><i class="fa fa-check"></i><b>4</b> Expectation and Variance</a><ul>
<li class="chapter" data-level="4.1" data-path="expectation-and-variance.html"><a href="expectation-and-variance.html#mathematical-expectation"><i class="fa fa-check"></i><b>4.1</b> Mathematical Expectation</a></li>
<li class="chapter" data-level="4.2" data-path="expectation-and-variance.html"><a href="expectation-and-variance.html#variance"><i class="fa fa-check"></i><b>4.2</b> Variance</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="some-discrete-distributions.html"><a href="some-discrete-distributions.html"><i class="fa fa-check"></i><b>5</b> Some Discrete Distributions</a><ul>
<li class="chapter" data-level="5.1" data-path="some-discrete-distributions.html"><a href="some-discrete-distributions.html#bernoulli-distribution"><i class="fa fa-check"></i><b>5.1</b> Bernoulli Distribution</a></li>
<li class="chapter" data-level="5.2" data-path="some-discrete-distributions.html"><a href="some-discrete-distributions.html#binomial-distribution"><i class="fa fa-check"></i><b>5.2</b> Binomial Distribution</a></li>
<li class="chapter" data-level="5.3" data-path="some-discrete-distributions.html"><a href="some-discrete-distributions.html#multinomial-distribution"><i class="fa fa-check"></i><b>5.3</b> Multinomial Distribution</a></li>
<li class="chapter" data-level="5.4" data-path="some-discrete-distributions.html"><a href="some-discrete-distributions.html#hypergeometric-distribution"><i class="fa fa-check"></i><b>5.4</b> Hypergeometric Distribution</a></li>
<li class="chapter" data-level="5.5" data-path="some-discrete-distributions.html"><a href="some-discrete-distributions.html#negative-binomial-distribution"><i class="fa fa-check"></i><b>5.5</b> Negative Binomial Distribution</a></li>
<li class="chapter" data-level="5.6" data-path="some-discrete-distributions.html"><a href="some-discrete-distributions.html#geometric-distribution"><i class="fa fa-check"></i><b>5.6</b> Geometric Distribution</a></li>
<li class="chapter" data-level="5.7" data-path="some-discrete-distributions.html"><a href="some-discrete-distributions.html#chapter-questions"><i class="fa fa-check"></i><b>5.7</b> Chapter Questions</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown.</a></li>
<li><a href="http://berkorbay.me" target="blank">Author: Berk Orbay</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Book of Prob</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="some-discrete-distributions" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Some Discrete Distributions</h1>
<div id="bernoulli-distribution" class="section level2">
<h2><span class="header-section-number">5.1</span> Bernoulli Distribution</h2>
<p>It can also be called “single coin toss distribution”. For a single event with probability of success <span class="math inline">\(p\)</span> and failure <span class="math inline">\(q = 1 - p\)</span>, the distribution is called Bernoulli.</p>
<ul>
<li><p>pmf: <span class="math inline">\(f(x = 0;p) = q\)</span>, <span class="math inline">\(f(x = 1) = p\)</span></p></li>
<li><p><span class="math inline">\(E[X] = 0*(1-p) + 1*p = p\)</span></p></li>
<li><p><span class="math inline">\(V[X] = pq\)</span></p></li>
</ul>
<p>Example: Coin Toss</p>
<ul>
<li><p><span class="math inline">\(p = 0.5\)</span>, <span class="math inline">\(q = 1 - p = 0.5\)</span></p></li>
<li><p>pmf: <span class="math inline">\(f(x = 0) = 0.5\)</span>, <span class="math inline">\(f(x = 1) = 0.5\)</span></p></li>
<li><p><span class="math inline">\(E[X] = 0*(1-0.5) + 1*0.5 = 0.5\)</span></p></li>
<li><p><span class="math inline">\(V(X) = 0.5*0.5 = 0.25\)</span></p></li>
</ul>
</div>
<div id="binomial-distribution" class="section level2">
<h2><span class="header-section-number">5.2</span> Binomial Distribution</h2>
<p>Think of multiple Bernoulli trials (e.g. several coin tosses).</p>
<ul>
<li><p>pmf: <span class="math inline">\(f(x;p,n) = \binom{n}{x} p^xq^{(n-x)}\)</span></p></li>
<li><p><span class="math inline">\(E[X] = np\)</span></p></li>
<li><p><span class="math inline">\(V(X) = npq\)</span></p></li>
<li><p>cdf: <span class="math inline">\(F(X \le x) = \sum_{i=0}^n f(i)\)</span></p></li>
</ul>
<p>Example: Multiple Coin Tosses (x5 coins, p = 0.5)</p>
<ul>
<li>pmf: <span class="math inline">\(f(x=3;n=5) = \binom{5}{3} (0.5)^3(1-0.5)^{(5-3)} = 0.3125\)</span></li>
</ul>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" data-line-number="1"><span class="co">#R way</span></a>
<a class="sourceLine" id="cb74-2" data-line-number="2"><span class="co">#(d)ensity(binom)ial</span></a>
<a class="sourceLine" id="cb74-3" data-line-number="3"><span class="kw">dbinom</span>(<span class="dt">x=</span><span class="dv">3</span>,<span class="dt">size=</span><span class="dv">5</span>,<span class="dt">prob=</span><span class="fl">0.5</span>)</a></code></pre></div>
<pre><code>## [1] 0.3125</code></pre>
<ul>
<li><p><span class="math inline">\(E[X] = 5*0.5 = 2.5\)</span></p></li>
<li><p><span class="math inline">\(V(X) = 5*0.5*0.5 = 1.25\)</span></p></li>
<li><p>cdf: <span class="math inline">\(F(X \le 3;n=5) = \sum_{i=0}^5 f(i) = 0.8125\)</span></p></li>
</ul>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" data-line-number="1"><span class="co">#R way</span></a>
<a class="sourceLine" id="cb76-2" data-line-number="2"><span class="kw">pbinom</span>(<span class="dt">q=</span><span class="dv">3</span>,<span class="dt">size=</span><span class="dv">5</span>,<span class="dt">prob=</span><span class="fl">0.5</span>)</a></code></pre></div>
<pre><code>## [1] 0.8125</code></pre>
</div>
<div id="multinomial-distribution" class="section level2">
<h2><span class="header-section-number">5.3</span> Multinomial Distribution</h2>
<p>Now suppose there is not one probability (<span class="math inline">\(p\)</span>) but there are many probabilities (<span class="math inline">\(p_1, p_2, \dots, p_k\)</span>).</p>
<ul>
<li><p>pmf: <span class="math inline">\(f(x_1, \dots , x_k;p_1, \dots, p_k;n) = \binom{n}{x_1, \dots , x_k} p_1^{x_1}*\dots *p_k^{x_k}\)</span></p>
<p>where <span class="math inline">\(\binom{n}{x_1, \dots , x_k} = \dfrac{n!}{x_1! \dots x_k!}\)</span>, <span class="math inline">\(\sum_i^k x_i = n\)</span> and <span class="math inline">\(\sum_i^k p_i = 1\)</span>.</p></li>
</ul>
<p>Example: Customers of a coffee shop prefer Turkish coffee with probability 0.4, espresso 0.25 and filter coffee 0.35. What is the probability that out of the first 10 customers, 3 will prefer Turkish coffee, 5 will prefer espresso and 2 will prefer filter coffee?</p>
<p><span class="math inline">\(f(3,5,2;0.4,0.25,0.35;10) = \binom{10}{3,5,2} * 0.4^3 * 0.25^5 * 0.35^10 = 4.3 * 10^{-6} = 0.0193\)</span></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" data-line-number="1"><span class="co">#Explicit form</span></a>
<a class="sourceLine" id="cb78-2" data-line-number="2"><span class="kw">factorial</span>(<span class="dv">10</span>)<span class="op">/</span>(<span class="kw">factorial</span>(<span class="dv">3</span>)<span class="op">*</span><span class="kw">factorial</span>(<span class="dv">5</span>)<span class="op">*</span><span class="kw">factorial</span>(<span class="dv">2</span>))<span class="op">*</span><span class="fl">0.4</span><span class="op">^</span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="fl">0.25</span><span class="op">^</span><span class="dv">5</span> <span class="op">*</span><span class="st"> </span><span class="fl">0.35</span><span class="op">^</span><span class="dv">2</span></a></code></pre></div>
<pre><code>## [1] 0.01929375</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" data-line-number="1"><span class="co">#Density multinomial</span></a>
<a class="sourceLine" id="cb80-2" data-line-number="2"><span class="kw">dmultinom</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">2</span>),<span class="dt">prob=</span><span class="kw">c</span>(<span class="fl">0.4</span>,<span class="fl">0.25</span>,<span class="fl">0.35</span>))</a></code></pre></div>
<pre><code>## [1] 0.01929375</code></pre>
<p>Binomial distribution is a special case of multinomial distribution.</p>
</div>
<div id="hypergeometric-distribution" class="section level2">
<h2><span class="header-section-number">5.4</span> Hypergeometric Distribution</h2>
<p>Hypergeometric distribution can be used in case the sample is divided in two such as defective/nondefective, white/black, Ankara/Istanbul. Suppose there are a total of <span class="math inline">\(N\)</span> items, <span class="math inline">\(k\)</span> of them are from group 1 and <span class="math inline">\(N-k\)</span> of them are from group 2. We want to know the probability of getting <span class="math inline">\(x\)</span> items from group 1 and <span class="math inline">\(n-k\)</span> items from group 2.</p>
<ul>
<li><p>pmf: <span class="math inline">\(f(x,n;k,N) = \dfrac{\binom{k}{x}\binom{N-k}{n-x}}{\binom{N}{n}}\)</span></p></li>
<li><p><span class="math inline">\(E[X] = \dfrac{nk}{N}\)</span></p></li>
<li><p><span class="math inline">\(V[X] = \dfrac{N-n}{N-1}*n*\dfrac{k}{N}*(1-\dfrac{k}{N})\)</span></p></li>
</ul>
<p>Example: Suppose we have a group of 20 people, 12 from Istanbul and 8 from Ankara. If we randomly select 5 people from it what is the probability that 1 of them is from Ankara and 4 of them from Istanbul.</p>
<p><span class="math inline">\(f(1,5;8,20) = \dfrac{\binom{8}{1}\binom{20-8}{5-1}}{\binom{20}{5}} = 0.256\)</span></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1"><span class="co">#Explicit form</span></a>
<a class="sourceLine" id="cb82-2" data-line-number="2">x=<span class="dv">1</span></a>
<a class="sourceLine" id="cb82-3" data-line-number="3">n=<span class="dv">5</span></a>
<a class="sourceLine" id="cb82-4" data-line-number="4">k=<span class="dv">8</span></a>
<a class="sourceLine" id="cb82-5" data-line-number="5">N=<span class="dv">20</span></a>
<a class="sourceLine" id="cb82-6" data-line-number="6">(<span class="kw">choose</span>(k,x)<span class="op">*</span><span class="kw">choose</span>(N<span class="op">-</span>k,n<span class="op">-</span>x))<span class="op">/</span><span class="kw">choose</span>(N,n)</a></code></pre></div>
<pre><code>## [1] 0.255418</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" data-line-number="1"><span class="co">#Density hypergeometric, see ?dhyper for explanations</span></a>
<a class="sourceLine" id="cb84-2" data-line-number="2"><span class="kw">dhyper</span>(<span class="dt">x=</span><span class="dv">1</span>,<span class="dt">m=</span><span class="dv">8</span>,<span class="dt">n=</span><span class="dv">12</span>,<span class="dt">k=</span><span class="dv">5</span>)</a></code></pre></div>
<pre><code>## [1] 0.255418</code></pre>
</div>
<div id="negative-binomial-distribution" class="section level2">
<h2><span class="header-section-number">5.5</span> Negative Binomial Distribution</h2>
<p>Negative Binomial distribution answers the question “What is the probability that k-th success occurs in n trials?”. Differently from the binomial case, we fix the last attempt as success.</p>
<ul>
<li>pmf: <span class="math inline">\(f(x;p,n) = \binom{n-1}{x-1} p^xq^{(n-x)}\)</span></li>
</ul>
<p>Example: Suppose I’m repeatedly tossing coins. What is the probability that 3rd Heads come in the 5th toss?</p>
<p><span class="math inline">\(f(3;0.5,5) = \binom{5-1}{3-1} 0.5^30.5^{(5-3)} = 0.1875\)</span></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" data-line-number="1"><span class="co">#Explicit form</span></a>
<a class="sourceLine" id="cb86-2" data-line-number="2"><span class="kw">choose</span>(<span class="dv">5-1</span>,<span class="dv">3-1</span>)<span class="op">*</span><span class="fl">0.5</span><span class="op">^</span><span class="dv">3</span><span class="op">*</span><span class="fl">0.5</span><span class="op">^</span>(<span class="dv">5-3</span>)</a></code></pre></div>
<pre><code>## [1] 0.1875</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" data-line-number="1"><span class="co">#Binomial way</span></a>
<a class="sourceLine" id="cb88-2" data-line-number="2"><span class="kw">dbinom</span>(<span class="dv">3-1</span>,<span class="dv">5-1</span>,<span class="fl">0.5</span>)<span class="op">*</span><span class="fl">0.5</span></a></code></pre></div>
<pre><code>## [1] 0.1875</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" data-line-number="1"><span class="co">#Negative binomial way</span></a>
<a class="sourceLine" id="cb90-2" data-line-number="2"><span class="kw">dnbinom</span>(<span class="dt">x=</span><span class="dv">5-3</span>,<span class="dt">size=</span><span class="dv">3</span>,<span class="dt">prob=</span><span class="fl">0.5</span>)</a></code></pre></div>
<pre><code>## [1] 0.1875</code></pre>
</div>
<div id="geometric-distribution" class="section level2">
<h2><span class="header-section-number">5.6</span> Geometric Distribution</h2>
<p>Geometric distribution answers “What is the probability that first success comes in the n-th trial?”</p>
<ul>
<li><p>pmf: <span class="math inline">\(f(x;p,n) = q^{(n-1)}p\)</span></p></li>
<li><p><span class="math inline">\(E[X] = 1/p\)</span></p></li>
<li><p><span class="math inline">\(V[X] = \dfrac{1-p}{p^2}\)</span></p></li>
</ul>
</div>
<div id="chapter-questions" class="section level2">
<h2><span class="header-section-number">5.7</span> Chapter Questions</h2>
<ol style="list-style-type: decimal">
<li><p>A boutique shop offers three types of breads; olive, rye and white. 15% of its customers buy olive bread, 55% rye bread and the rest white bread. What is the probability that the first 10 customers of the shop buys 2 olive, 5 rye and 3 white bread?</p>
<p><em>Solution:</em> Multinomial distribution.</p>
<p><span class="math display">\[\binom{10}{2,5,3} 0.15^2 * 0.55^5 * 0.3^3 = 0.0770478\]</span></p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" data-line-number="1">n_total =<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb92-2" data-line-number="2"><span class="co"># Olive bread</span></a>
<a class="sourceLine" id="cb92-3" data-line-number="3">p_<span class="dv">1</span> =<span class="st"> </span><span class="fl">0.15</span></a>
<a class="sourceLine" id="cb92-4" data-line-number="4">n_<span class="dv">1</span> =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb92-5" data-line-number="5"><span class="co"># Rye bread</span></a>
<a class="sourceLine" id="cb92-6" data-line-number="6">p_<span class="dv">2</span> =<span class="st"> </span><span class="fl">0.55</span></a>
<a class="sourceLine" id="cb92-7" data-line-number="7">n_<span class="dv">2</span> =<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb92-8" data-line-number="8"><span class="co"># White bread</span></a>
<a class="sourceLine" id="cb92-9" data-line-number="9">p_<span class="dv">3</span> =<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p_<span class="dv">2</span> <span class="op">-</span><span class="st"> </span>p_<span class="dv">1</span></a>
<a class="sourceLine" id="cb92-10" data-line-number="10">n_<span class="dv">3</span> =<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb92-11" data-line-number="11"></a>
<a class="sourceLine" id="cb92-12" data-line-number="12"><span class="kw">factorial</span>(n_total)<span class="op">/</span>(<span class="kw">factorial</span>(n_<span class="dv">1</span>)<span class="op">*</span><span class="kw">factorial</span>(n_<span class="dv">2</span>)<span class="op">*</span><span class="kw">factorial</span>(n_<span class="dv">3</span>)) <span class="op">*</span><span class="st"> </span>p_<span class="dv">1</span><span class="op">^</span>n_<span class="dv">1</span> <span class="op">*</span><span class="st"> </span>p_<span class="dv">2</span><span class="op">^</span>n_<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>p_<span class="dv">3</span><span class="op">^</span>n_<span class="dv">3</span></a></code></pre></div>
<pre><code>## [1] 0.0770478</code></pre></li>
<li><p>An urn contains 32 balls; 18 red, 14 white. If I take 8 balls randomly from the urn, what is the probability of getting 4 red balls?</p>
<p><em>Solution:</em> Hypergeometric distribution.</p>
<p><span class="math display">\[\dfrac{\binom{18}{4}\binom{14}{4}}{\binom{32}{8}} = 0.2912125\]</span></p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" data-line-number="1">n_total =<span class="st"> </span><span class="dv">32</span> <span class="co">#N</span></a>
<a class="sourceLine" id="cb94-2" data-line-number="2">k_total =<span class="st"> </span><span class="dv">8</span></a>
<a class="sourceLine" id="cb94-3" data-line-number="3">n_<span class="dv">1</span> =<span class="st"> </span><span class="dv">18</span></a>
<a class="sourceLine" id="cb94-4" data-line-number="4">n_<span class="dv">2</span> =<span class="st"> </span><span class="dv">14</span></a>
<a class="sourceLine" id="cb94-5" data-line-number="5">k_<span class="dv">1</span> =<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb94-6" data-line-number="6">k_<span class="dv">2</span> =<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb94-7" data-line-number="7"></a>
<a class="sourceLine" id="cb94-8" data-line-number="8">(<span class="kw">choose</span>(n_<span class="dv">1</span>,k_<span class="dv">1</span>)<span class="op">*</span><span class="kw">choose</span>(n_<span class="dv">2</span>,k_<span class="dv">2</span>))<span class="op">/</span><span class="kw">choose</span>(n_total,k_total)</a></code></pre></div>
<pre><code>## [1] 0.2912125</code></pre></li>
<li><p>A UNICEF activist asks bypassers to contribute to their efforts. Each of her attempts has a 10% chance of success. What is the probability that she got the first contribution at the 10th attempt?</p>
<p><em>Solution:</em> Geometric distribution.</p>
<p><span class="math display">\[ (0.9)^9 * (0.1) = 0.03874205\]</span></p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" data-line-number="1">(<span class="fl">0.9</span>)<span class="op">^</span><span class="dv">9</span> <span class="op">*</span><span class="st"> </span>(<span class="fl">0.1</span>)</a></code></pre></div>
<pre><code>## [1] 0.03874205</code></pre></li>
<li><p>Suppose there are 10 cards in a deck numbered from 1 to 10. If I draw four cards out of the deck without putting them back, what is the probability that they are in increasing order (e.g. 3-4-5-8)?</p>
<p><em>Solution</em>: Increasing order is a special order. There is only one decreasing order in every permutation set. For instance</p>
<p><span class="math display">\[8-5-4-3\]</span>
<span class="math display">\[8-5-3-4\]</span>
<span class="math display">\[8-4-5-3\]</span>
<span class="math display">\[4-5-3-8\]</span>
<span class="math display">\[\dots\]</span>
<span class="math display">\[**3-4-5-8**\]</span></p>
<p>So, the answer is <span class="math inline">\(1/(4!) = 1/24\)</span>.</p></li>
<li><p>A tennis player has the probability of 0.15 to ace a serve (i.e. he serves and gets the point without the opponent touching the ball) at each shot. His trainer challenged him that he will pay the square of the aces he makes out of 10 serves (e.g. if he serves 8 aces out of 10, the trainer pays him <span class="math inline">\(8^2 = 64TL\)</span>). But, if he serves less than or equal to 6 aces, the player should pay the trainer 5 TL for each ace he missed (e.g. 4 aces 6 misses, player pays up 6*5 = 30TL).</p>
<ol style="list-style-type: lower-alpha">
<li>What is the maximum amount of money he can get?</li>
<li>What is the expected earnings of the player?</li>
<li>What is the variance of his earnings?</li>
</ol>
<p><em>Solution:</em></p>
<ol style="list-style-type: lower-alpha">
<li>10 out of 10 means 10^2 = 100.</li>
<li><p><span class="math inline">\(g(X = x) = x^2\)</span> if <span class="math inline">\(x \geq 7\)</span>, <span class="math inline">\(f(g(X) = x^2) = f(X = x) = \binom{10}{x} 0.15^x * 0.85^(10-k)\)</span>, so <span class="math inline">\(E[g(x)] = \sum_{i=0}^10 g(x)f(x)\)</span>.</p>
<p><span class="math inline">\(g(X = x) = -5*x\)</span> if <span class="math inline">\(x \leq 6\)</span>.</p>
<p>So <span class="math inline">\(49 * \binom{10}{7} 0.15^7 * 0.85^3 + 64 * \binom{10}{8} 0.15^8 * 0.85^2 + 81 * \binom{10}{9} 0.15^9 * 0.85 + 100 * (0.15)^10\)</span> <span class="math inline">\(-20 * \binom{10}{6} 0.15^6 * 0.85^4 -25 * \binom{10}{5} 0.15^5 * 0.85^5 - 30 * \binom{10}{4} 0.15^4 * 0.85^6 - 35 * \binom{10}{3} 0.15^3 * 0.85^7 - 40 * \binom{10}{2} 0.15^2 * 0.85^8 - 45 * \binom{10}{1} 0.15^1 * 0.85^9 - 50 * 0.85^10 = -42.5TL\)</span>.</p></li>
</ol>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" data-line-number="1">rewards &lt;-<span class="st"> </span>(<span class="dv">7</span><span class="op">:</span><span class="dv">10</span>)<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb98-2" data-line-number="2">probs_rewards &lt;-<span class="st"> </span><span class="kw">dbinom</span>(<span class="dv">7</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">10</span>,<span class="fl">0.15</span>)</a>
<a class="sourceLine" id="cb98-3" data-line-number="3">losses &lt;-<span class="st"> </span><span class="dv">-5</span><span class="op">*</span>(<span class="dv">10</span><span class="op">-</span>(<span class="dv">6</span><span class="op">:</span><span class="dv">0</span>))</a>
<a class="sourceLine" id="cb98-4" data-line-number="4">probs_losses &lt;-<span class="st"> </span><span class="kw">dbinom</span>(<span class="dv">6</span><span class="op">:</span><span class="dv">0</span>,<span class="dv">10</span>,<span class="fl">0.15</span>)</a>
<a class="sourceLine" id="cb98-5" data-line-number="5"></a>
<a class="sourceLine" id="cb98-6" data-line-number="6">expectation &lt;-<span class="st"> </span><span class="kw">sum</span>(rewards<span class="op">*</span>probs_rewards) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(losses<span class="op">*</span>probs_losses)</a>
<a class="sourceLine" id="cb98-7" data-line-number="7">expectation</a></code></pre></div>
<pre><code>## [1] -42.4913</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li><span class="math inline">\(V(X) = E[X^2] - (E[X])^2\)</span>. We know that <span class="math inline">\(E[X] = -42.5\)</span>, then <span class="math inline">\((E[X])^2 = 1805.51\)</span>. Also <span class="math inline">\(E[X^2] = 1838.434\)</span> and <span class="math inline">\(V(X) = 32.92\)</span>.</li>
</ol>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" data-line-number="1">ex2&lt;-<span class="kw">sum</span>(rewards<span class="op">^</span><span class="dv">2</span><span class="op">*</span>probs_rewards) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(losses<span class="op">^</span><span class="dv">2</span><span class="op">*</span>probs_losses)</a>
<a class="sourceLine" id="cb100-2" data-line-number="2">ex2 <span class="op">-</span><span class="st"> </span>expectation<span class="op">^</span><span class="dv">2</span></a></code></pre></div>
<pre><code>## [1] 32.92423</code></pre></li>
</ol>

<div id="refs" class="references">
<div>
<p>Walpole, Ronald E., Raymond H. Myers, Sharon L. Myers, and Keying Ye. 2012. <em>Probability and Statistics for Engineers and Scientists</em>. 9th ed. Boston, MA: Pearson.</p>
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="expectation-and-variance.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["book-of-prob.pdf", "book-of-prob.epub"],
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
